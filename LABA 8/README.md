# Создание собственного COM объекта

Мы разработаем приложение по типу «Калькулятор», которое будет реализовывать 4 функции: сложение, вычитание, умножение и деление. Для реализации приложения реализуем свой COM объект. Для этого мы создадим класс и зарегистрируем его как динамическую библиотеку в системе. После этого мы создадим клиента с графическим интерфейсом, к которому подключим ссылку на зарегистрированный COM объект. После этого мы можем использовать интерфейс этого объекта.

Использование COM объектов позволяет пользователю достаточно просто обращаться из любого инструмента, поддерживающего COM, к интересующим его интерфейсам.
 
#  Опишите процедуру создания COM объекта?
Для создания COM объекта необходимо создать новую библиотеку классов и установить ей свойство регистрация для COM-взаимодействия. В коде COM объекта необходимо создать класс и интерфейс. Класс и интерфейс нужно пометить рядом атрибутов: следует указать для них уникальные GUID-ы, указать ComVisible(true) , а для класса также добавить атрибут ClassInterface(ClassInterfaceType.None). После этого необходимо собрать проект.

#  Что такое интерфейс СОМ объекта, его назначение?
Свои функции COM объекты поставляют через интерфейс. Интерфейс - это указатель на функции вызываемые клиентом. При взаимодействии между клиентом и объектом COM определяется: 
- уникальный идентификатор
- местоположение функции в интерфейсе 
- назначение функции 
- аргументы и возвращаемое значение 

#  Назначение библиотеки СОМ. Механизм создания первого экземпляра объекта с помощью библиотеки СОМ и системного реестра.
Библиотека СОМ предназначена для выполнения базовых функций и идентификации требуемого интерфейса. При попытке клиента использовать некоторый объект СОМ, который до этого момента не использовался и, следовательно, клиент не мог получить указатели на объект и интерфейс, он обращается к библиотеке СОМ и вызывает метод CoCreateInstance, передавая ей в качестве параметра CLSID нужного класса, IDD интерфейса и требуемый тип сервера.

Библиотека при помощи диспетчера управления службами обращается в системному реестру, по идентификатору класса находит информацию и сервере и запускает его. Сервер создает экземпляр класса – объект, и возвращает библиотеке указатель на запрошенный интерфейс.

Библиотека СОМ передает указатель клиенту, который впоследствии может обращаться непосредственно к объекту.

#  Что такое СОМ-сервер?
COM-сервер — это специальным образом оформленное и зарегистрированное в системе приложение, которое позволяет клиентам запрашивать у себя создание реализованных в нем объектов. Сервер может быть выполнен в виде либо динамической библиотеки, либо исполняемого файла.